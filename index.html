<!-- ============================================================
 A TO Z Cleaning Expert Ltd. — Walkthrough & Internal Assessment Tool (Pro v3)
 Full-width | Modern White/Blue | Local Save | Review + PDF + Gmail
=============================================================== -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A TO Z Cleaning Expert Ltd. — Walkthrough Tool (Pro v3)</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
:root{
  --primary:#0056D2;--accent:#00C2FF;
  --background:#F9FAFB;--surface:#FFFFFF;
  --text:#1E1E1E;--muted:#6B7280;--border:#E5E7EB;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{
  font-family:'Poppins',sans-serif;
  background:var(--background);color:var(--text);
  display:flex;flex-direction:column;min-height:100vh;
}
header{
  background:#fff;display:flex;align-items:center;gap:15px;
  padding:15px 25px;border-bottom:1px solid var(--border);
  box-shadow:0 2px 6px rgba(0,0,0,.05);
}
header img{height:60px;}
.header-text h1{margin:0;font-size:1.3rem;color:var(--primary);font-weight:600;}
.header-text p{margin:0;color:var(--muted);font-size:.9rem;}
main{flex:1;width:100%;padding:30px 10%;background:var(--surface);}
section{display:none;}
section.active{display:block;animation:fade .4s;}
@keyframes fade{from{opacity:0;transform:translateY(8px);}to{opacity:1;transform:translateY(0);}}
#progressWrapper{margin:15px 10%;}
#progressLabel{display:flex;justify-content:space-between;font-size:.9rem;color:var(--muted);margin-bottom:5px;}
#progressContainer{background:#e5e7eb;border-radius:20px;height:10px;overflow:hidden;}
#progressBar{height:100%;background:linear-gradient(90deg,var(--primary),var(--accent));width:0%;transition:width .3s ease;}
label{display:block;margin:10px 0 5px;font-weight:500;}
input,select,textarea{
  width:100%;padding:9px 10px;border:1px solid var(--border);
  border-radius:6px;background:#fff;font-size:.95rem;
}
textarea{resize:vertical;}
button{
  background:var(--primary);color:#fff;border:none;border-radius:6px;
  padding:10px 18px;font-size:.95rem;font-weight:500;cursor:pointer;
  transition:.25s ease;box-shadow:0 2px 5px rgba(0,0,0,.1);
}
button:hover{background:#0042A2;}
.nav-buttons{display:flex;justify-content:space-between;margin-top:30px;margin-bottom:40px;}
.addon-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(230px,1fr));gap:10px;margin-top:8px;}
.addon-item{display:flex;align-items:center;gap:8px;padding:8px 12px;border:1px solid var(--border);border-radius:6px;background:#fdfdfd;}
.addon-item input{transform:scale(1.1);}
footer{
  flex-shrink:0;text-align:center;font-size:.85rem;color:#fff;
  background:linear-gradient(90deg,var(--primary),var(--accent));
  padding:15px 0;margin-top:auto;box-shadow:0 -2px 6px rgba(0,0,0,.05);
}
#saveToast{position:fixed;top:15px;right:15px;background:var(--primary);color:#fff;
  padding:8px 14px;border-radius:6px;font-size:.85rem;display:none;box-shadow:0 2px 6px rgba(0,0,0,.2);}
</style>
</head>

<body>
<header>
  <img src="images/a-to-z-logo.png" alt="A TO Z Cleaning Expert Logo">
  <div class="header-text">
    <h1>A TO Z CLEANING EXPERT LTD.</h1>
    <p>Comprehensive Walkthrough & Internal Assessment Tool</p>
  </div>
</header>

<div id="progressWrapper">
  <div id="progressLabel"><span id="progressTitle">Client Information</span><span id="progressText">Step 1 of 10</span></div>
  <div id="progressContainer"><div id="progressBar"></div></div>
</div>

<div id="saveToast">Saved locally</div>

<main>
<form id="walkthroughForm">

<!-- STEP 1 -->
<section id="step1" class="active">
  <h2><i class="fa fa-user-tie"></i> Client & Site Information</h2>
  <label for="assessorName">Assessor Name</label><input type="text" id="assessorName" name="assessorName" required>
  <label for="clientName">Client / Company Name</label><input type="text" id="clientName" name="clientName" required>
  <label for="contactPerson">Contact Person</label><input type="text" id="contactPerson" name="contactPerson">
  <label for="email">Email</label><input type="email" id="email" name="email">
  <label for="phone">Phone</label><input type="text" id="phone" name="phone">
  <label for="address">Site Address</label><textarea id="address" name="address" rows="2"></textarea>
  <label for="facilityType">Type of Facility</label>
  <select id="facilityType" name="facilityType"><option value="">Select</option><option>Office</option><option>Retail</option><option>Medical</option><option>Industrial</option><option>School</option><option>Condominium</option></select>
  <label for="hours">Hours of Operation</label><input type="text" id="hours" name="hours" placeholder="e.g. Mon–Fri 8 AM – 6 PM">
  <div class="nav-buttons"><span></span><button type="button" id="next1">Next</button></div>
</section>

<!-- STEP 2 -->
<section id="step2">
  <h2><i class="fa fa-building"></i> Facility Overview</h2>
  <label for="squareFootage">Total Square Footage</label><input type="number" id="squareFootage" name="squareFootage" placeholder="e.g. 10000" required>
  <label for="floors">Number of Floors</label><input type="number" id="floors" name="floors">
  <label>Flooring Types</label>
  <div class="addon-grid">
    <div class="addon-item"><input type="checkbox" name="flooring" value="Tile"><label>Tile</label></div>
    <div class="addon-item"><input type="checkbox" name="flooring" value="Carpet"><label>Carpet</label></div>
    <div class="addon-item"><input type="checkbox" name="flooring" value="Vinyl"><label>Vinyl</label></div>
    <div class="addon-item"><input type="checkbox" name="flooring" value="Hardwood"><label>Hardwood</label></div>
    <div class="addon-item"><input type="checkbox" name="flooring" value="Concrete"><label>Concrete</label></div>
  </div>
  <label for="frequency">Cleaning Frequency</label>
  <select id="frequency" name="frequency"><option value="">Select</option><option>Weekly (1×/week)</option><option>Twice a week</option><option>Three times a week</option><option>Five times a week</option><option>Daily</option></select>
  <label for="provider">Current Cleaning Provider</label><input type="text" id="provider" name="provider">
  <label for="painPoints">Main Pain Points / Concerns</label><textarea id="painPoints" name="painPoints" rows="2"></textarea>
  <label for="startDate">Preferred Start Date</label><input type="date" id="startDate" name="startDate">
  <div class="nav-buttons"><button type="button" id="prev2">Previous</button><button type="button" id="next2">Next</button></div>
</section>

<!-- STEP 3 -->
<section id="step3">
  <h2><i class="fa fa-clipboard-check"></i> Area-by-Area Inspection</h2>
  <label>Offices / Work Areas</label><textarea name="officeNotes" rows="2"></textarea>
  <label>Restrooms</label><textarea name="restroomNotes" rows="2"></textarea>
  <label>Break Room / Kitchen</label><textarea name="kitchenNotes" rows="2"></textarea>
  <label>Windows & Glass</label><textarea name="windowNotes" rows="2"></textarea>
  <label>Floors & Carpets</label><textarea name="floorNotes" rows="2"></textarea>
  <div class="nav-buttons"><button type="button" id="prev3">Previous</button><button type="button" id="next3">Next</button></div>
</section>

<!-- STEP 4 -->
<section id="step4">
  <h2><i class="fa fa-plus-circle"></i> Specialty & Add-On Services</h2>
  <div class="addon-grid">
    <div class="addon-item"><input type="checkbox" name="addons" value="Post-Construction Cleaning"><label>Post-Construction Cleaning</label></div>
    <div class="addon-item"><input type="checkbox" name="addons" value="Floor Strip & Wax"><label>Floor Strip & Wax</label></div>
    <div class="addon-item"><input type="checkbox" name="addons" value="Carpet Extraction"><label>Carpet Extraction</label></div>
    <div class="addon-item"><input type="checkbox" name="addons" value="High Dusting / Vents"><label>High Dusting / Vents</label></div>
    <div class="addon-item"><input type="checkbox" name="addons" value="Window Washing"><label>Window Washing</label></div>
  </div>
  <div class="nav-buttons"><button type="button" id="prev4">Previous</button><button type="button" id="next4">Next</button></div>
</section>

<!-- STEP 5 -->
<section id="step5">
  <h2><i class="fa fa-building-columns"></i> Facility Composition</h2>
  <label for="numRestrooms">Number of Restrooms</label><input type="number" id="numRestrooms" name="numRestrooms">
  <label for="numKitchens">Number of Kitchens / Break Areas</label><input type="number" id="numKitchens" name="numKitchens">
  <label for="ceilingType">Type of Ceiling</label>
  <select id="ceilingType" name="ceilingType"><option value="">Select</option><option>Drop Tile</option><option>Drywall</option><option>Open Industrial</option></select>
  <label for="entrances">Number of Entrances</label><input type="number" id="entrances" name="entrances">
  <label for="cleaningHours">Allowed Cleaning Hours</label>
  <select id="cleaningHours" name="cleaningHours"><option value="">Select</option><option>Daytime</option><option>Evening</option><option>Nighttime</option></select>
  <div class="nav-buttons"><button type="button" id="prev5">Previous</button><button type="button" id="next5">Next</button></div>
</section>

<!-- END OF PART 1 -->
<!-- ============================================================
 PART 2 — STEPS 6 TO 10 + UPDATED CALCULATOR + LOGIC
=============================================================== -->
<!-- ============================================================
 PART 2 — STEPS 6 TO 10  +  UPDATED DYNAMIC MONTHLY PRICING ESTIMATOR
=============================================================== -->

<!-- STEP 6 -->
<section id="step6">
  <h2><i class="fa fa-users"></i> Occupancy & Usage</h2>
  <label for="avgOccupancy">Average Daily Occupancy</label>
  <input type="number" id="avgOccupancy" name="avgOccupancy">
  <label for="peakHours">Peak Usage Hours</label>
  <input type="text" id="peakHours" name="peakHours">
  <label for="eventFrequency">Special Event Frequency</label>
  <select id="eventFrequency" name="eventFrequency">
    <option value="">Select</option><option>Rarely (less than once a month)</option>
    <option>Monthly</option><option>Weekly</option><option>Daily</option>
  </select>
  <div class="nav-buttons"><button type="button" id="prev6">Previous</button><button type="button" id="next6">Next</button></div>
</section>

<!-- STEP 7 -->
<section id="step7">
  <h2><i class="fa fa-broom"></i> Cleaning Scope & Operational Details</h2>
  <label for="trashHandling">Trash Removal Responsibility</label>
  <select id="trashHandling" name="trashHandling">
    <option value="">Select</option>
    <option>Client handles waste disposal</option>
    <option>Cleaning team removes all trash</option>
    <option>Shared responsibility</option>
  </select>
  <label for="consumables">Restroom Consumables Supply</label>
  <select id="consumables" name="consumables">
    <option value="">Select</option><option>Client-supplied</option><option>Cleaning contractor-supplied</option>
  </select>
  <label for="disinfectionAreas">Disinfection Focus Areas</label>
  <textarea id="disinfectionAreas" name="disinfectionAreas" rows="2"></textarea>
  <label for="onSiteEquipment">On-Site Cleaning Equipment Available</label>
  <textarea id="onSiteEquipment" name="onSiteEquipment" rows="2"></textarea>
  <label for="storageSpace">Storage Space Available for Supplies</label>
  <select id="storageSpace" name="storageSpace">
    <option value="">Select</option><option>Yes</option><option>No</option><option>Limited</option>
  </select>
  <label for="waterAccess">Water Source / Drain Availability</label>
  <select id="waterAccess" name="waterAccess">
    <option value="">Select</option><option>Readily available</option><option>Limited access</option><option>No on-site access</option>
  </select>
  <div class="nav-buttons"><button type="button" id="prev7">Previous</button><button type="button" id="next7">Next</button></div>
</section>

<!-- STEP 8 -->
<section id="step8">
  <h2><i class="fa fa-clipboard-list"></i> Compliance & Sustainability</h2>
  <label for="insuranceReq">Insurance Requirements</label>
  <select id="insuranceReq" name="insuranceReq">
    <option value="">Select</option>
    <option>WSIB Certificate Required</option><option>General Liability Insurance Required</option>
    <option>Both</option><option>Not Required</option>
  </select>
  <label for="checkIn">Preferred Supervision / Check-in Method</label>
  <select id="checkIn" name="checkIn">
    <option value="">Select</option><option>Sign-in Sheet</option><option>Photo Proof via App</option><option>Verbal Confirmation</option>
  </select>
  <label for="compliance">Compliance Standards</label>
  <select id="compliance" name="compliance">
    <option value="">Select</option><option>ISO 9001</option><option>GMP / Food Safety</option><option>LEED Certification</option><option>Other</option>
  </select>
  <label for="ecoFriendly">Use of Eco-Friendly Cleaning Products?</label>
  <select id="ecoFriendly" name="ecoFriendly">
    <option value="">Select</option><option>Yes, mandatory</option><option>Preferred if available</option><option>No preference</option>
  </select>
  <label for="fragranceRestriction">Fragrance / Chemical Restrictions</label>
  <select id="fragranceRestriction" name="fragranceRestriction">
    <option value="">Select</option><option>Fragrance-Free Only</option><option>Low-VOC</option><option>No Restrictions</option>
  </select>
  <div class="nav-buttons"><button type="button" id="prev8">Previous</button><button type="button" id="next8">Next</button></div>
</section>

<!-- STEP 9 — UPDATED DYNAMIC MONTHLY PRICING ESTIMATOR -->
<section id="step9">
  <h2><i class="fa fa-calculator"></i> Dynamic Monthly Pricing Estimator</h2>
  <p>Estimate your monthly cleaning cost based on work hours, payroll, and overhead.</p>

  <label for="hoursPerDay">Hours Worked per Day</label>
  <input type="number" id="hoursPerDay" placeholder="e.g. 6" step="0.1">
  <label for="daysPerWeek">Days Worked per Week</label>
  <input type="number" id="daysPerWeek" placeholder="e.g. 5" step="1">
  <label for="hourlyRate">Employee Hourly Rate (CAD)</label>
  <input type="number" id="hourlyRate" placeholder="e.g. 25" step="0.01">
  <label for="overhead">Overhead Cost (%)</label>
  <input type="number" id="overhead" placeholder="e.g. 10" step="0.1">
  <label for="salesTax">Sales Tax (%)</label>
  <input type="number" id="salesTax" placeholder="e.g. 13" step="0.1">
  <label for="profit">Profit (%)</label>
  <input type="number" id="profit" placeholder="e.g. 20" step="0.1">

  <div id="calcResults" style="margin-top:15px;padding:15px;border:1px solid #E5E7EB;border-radius:6px;background:#F9FAFB;display:none;">
    <h3 style="margin-top:0;color:#0056D2;">Estimated Monthly Breakdown</h3>
    <p><strong>Labor Cost:</strong> <span id="laborCost">$0.00</span></p>
    <p><strong>Payroll Tax (10%):</strong> <span id="payrollTax">$0.00</span></p>
    <p><strong>Profit Amount:</strong> <span id="profitAmount">$0.00</span></p>
    <p><strong>Sales Tax Amount:</strong> <span id="salesTaxAmount">$0.00</span></p>
    <hr style="border:none;border-top:1px solid #ddd;margin:10px 0;">
    <p><strong>Total Before Tax:</strong> <span id="totalBeforeTax">$0.00</span></p>
    <p><strong>Total After Tax:</strong> <span id="totalAfterTax">$0.00</span></p>
  </div>

  <div class="nav-buttons">
    <button type="button" id="prev9">Previous</button>
    <button type="button" id="calcEstimate"><i class="fa fa-calculator"></i> Calculate</button>
    <button type="button" id="next9">Next</button>
  </div>
</section>

<!-- STEP 10 -->
<section id="step10">
  <h2><i class="fa fa-eye"></i> Review & Export Summary</h2>
  <p>Review all information before exporting or emailing the walkthrough report.</p>
  <div id="summaryContent" style="background:#F9FAFB;border:1px solid #E5E7EB;border-radius:8px;padding:15px;margin-bottom:20px;max-height:400px;overflow:auto;"></div>
  <div class="nav-buttons">
    <button type="button" id="prev10">Previous</button>
    <button type="button" id="downloadPDF"><i class="fa fa-file-pdf"></i> Download PDF</button>
    <button type="button" id="emailGmail"><i class="fa fa-envelope"></i> Email via Gmail</button>
  </div>
</section>

</form>
</main>

<footer>© 2025 A TO Z Cleaning Expert Ltd. - All rights reserved.</footer>

<!-- ========================= JAVASCRIPT ========================= -->
<script>
const totalSteps=10;let currentStep=1;
const titles=["Client Information","Facility Overview","Area Inspection","Add-On Services","Facility Composition","Occupancy & Usage","Cleaning Scope","Compliance & Sustainability","Pricing Estimator","Review & Export"];

function showStep(step){
  document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
  document.getElementById(`step${step}`).classList.add("active");
  document.getElementById("progressBar").style.width=(step/totalSteps*100)+"%";
  document.getElementById("progressText").textContent=`Step ${step} of ${totalSteps}`;
  document.getElementById("progressTitle").textContent=titles[step-1]||"";
  currentStep=step;saveData();window.scrollTo({top:0,behavior:"smooth"});
  if(step===10)generateSummary();
}
for(let i=1;i<=totalSteps;i++){const n=document.getElementById(`next${i}`),p=document.getElementById(`prev${i}`);if(n)n.addEventListener("click",()=>showStep(i+1));if(p)p.addEventListener("click",()=>showStep(i-1));}

/* Auto-save + Toast */
function saveData(){const f=document.getElementById("walkthroughForm");const d=new FormData(f);let obj={};d.forEach((v,k)=>obj[k]=v);obj.step=currentStep;localStorage.setItem("AtoZWalkthrough",JSON.stringify(obj));showToast();}
function loadData(){const s=localStorage.getItem("AtoZWalkthrough");if(!s)return;const obj=JSON.parse(s),f=document.getElementById("walkthroughForm");for(const k in obj){if(f.elements[k])f.elements[k].value=obj[k];}if(obj.step)showStep(obj.step);}
window.addEventListener("load",loadData);
document.getElementById("walkthroughForm").addEventListener("input",saveData);
function showToast(){const t=document.getElementById("saveToast");t.style.display="block";t.style.opacity="1";setTimeout(()=>t.style.opacity="0",1500);setTimeout(()=>t.style.display="none",1800);}

/* Pricing Estimator – Fixed Display */
document.getElementById("calcEstimate").addEventListener("click",()=>{
  const hpd=parseFloat(document.getElementById("hoursPerDay").value)||0;
  const dpw=parseFloat(document.getElementById("daysPerWeek").value)||0;
  const rate=parseFloat(document.getElementById("hourlyRate").value)||0;
  const overhead=parseFloat(document.getElementById("overhead").value)||0;
  const salesTax=parseFloat(document.getElementById("salesTax").value)||0;
  const profit=parseFloat(document.getElementById("profit").value)||0;

  const hoursWeek=hpd*dpw;
  const hoursYear=hoursWeek*52;
  const hoursMonth=hoursYear/12;

  const laborCostVal=hoursMonth*rate;
  const payrollTaxVal=laborCostVal*0.10;
  const profitAmt=laborCostVal*(profit/100);
  const overheadAmt=laborCostVal*(overhead/100);
  const totalBeforeTaxVal=laborCostVal+payrollTaxVal+overheadAmt+profitAmt;
  const salesTaxAmt=totalBeforeTaxVal*(salesTax/100);
  const totalAfterTaxVal=totalBeforeTaxVal+salesTaxAmt;

  const fmt=new Intl.NumberFormat('en-CA',{style:'currency',currency:'CAD',minimumFractionDigits:2});
  document.getElementById("laborCost").textContent=fmt.format(laborCostVal);
  document.getElementById("payrollTax").textContent=fmt.format(payrollTaxVal);
  document.getElementById("profitAmount").textContent=fmt.format(profitAmt);
  document.getElementById("salesTaxAmount").textContent=fmt.format(salesTaxAmt);
  document.getElementById("totalBeforeTax").textContent=fmt.format(totalBeforeTaxVal);
  document.getElementById("totalAfterTax").textContent=fmt.format(totalAfterTaxVal);
  document.getElementById("calcResults").style.display="block";
  saveData();
});

/* Summary */
function generateSummary(){const f=document.getElementById("walkthroughForm");const data=new FormData(f);let html=`<h3 style='margin-top:0;color:#0056D2;'>A TO Z CLEANING EXPERT LTD. – Walkthrough Summary</h3>`;html+=`<p><strong>Assessor:</strong> ${f.assessorName.value||"N/A"} <br><strong>Date:</strong> ${new Date().toLocaleDateString()}</p>`;data.forEach((v,k)=>{if(v)html+=`<p><strong>${k.replace(/([A-Z])/g," $1").replace(/\b\w/g,l=>l.toUpperCase())}:</strong> ${v}</p>`;});summaryContent.innerHTML=html;}

/* PDF Export */
downloadPDF.addEventListener("click",()=>{const {jsPDF}=window.jspdf;const doc=new jsPDF({unit:"pt",format:"a4"});const f=document.getElementById("walkthroughForm");const assessor=f.assessorName.value||"N/A";const today=new Date().toLocaleDateString();doc.setFont("helvetica","bold");doc.text("A TO Z CLEANING EXPERT LTD.",40,50);doc.setFontSize(10);doc.text("Walkthrough & Internal Assessment Report",40,65);doc.addImage("images/a-to-z-logo.png","PNG",440,30,100,50);doc.setFontSize(11);doc.text(`Assessor: ${assessor}`,40,100);doc.text(`Date: ${today}`,40,115);doc.line(40,125,550,125);let y=145;const data=new FormData(f);data.forEach((v,k)=>{if(v){doc.setFont("helvetica","bold");doc.text(`${k}:`,40,y);doc.setFont("helvetica","normal");const lines=doc.splitTextToSize(v,450);doc.text(lines,150,y);y+=lines.length*14+5;if(y>760){doc.addPage();y=60;}}});doc.line(40,780,550,780);doc.setFontSize(9);doc.text("© 2025 A TO Z Cleaning Expert Ltd. All rights reserved.",150,795);doc.save(`AtoZ_Walkthrough_Report_${today}.pdf`);});

/* Gmail Compose */
emailGmail.addEventListener("click",()=>{const subject=encodeURIComponent("A TO Z Walkthrough Report");const body=encodeURIComponent(summaryContent.innerText);window.open(`https://mail.google.com/mail/?view=cm&fs=1&su=${subject}&body=${body}`,"_blank");});
</script>
</body>
</html>
